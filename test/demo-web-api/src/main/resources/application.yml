spring:
  application:
    name: web-app
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration

# Web 服务配置
server:
  port: ${WEB_SERVER_PORT:8080}
  servlet:
    context-path: /

# gRPC 客户端配置
grpc:
  server:
    enabled: false  # 显式禁用 gRPC 服务端
    port: -1        # 设置端口为 -1 进一步确保不启动
  client:
    # UserService 客户端配置
    user-service:
      address: static://localhost:8081
      negotiationType: plaintext
    # OrderService 客户端配置
    order-service:
      address: static://localhost:8082
      negotiationType: plaintext

# 日志配置
logging:
  level:
    com.ddm.demo: DEBUG
    com.ddm.argus: INFO
    net.devh.boot.grpc: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{lane:--}] [%X{traceId:--}] %logger{36} - %msg%n"

chaos:
  config-center:
    namespace: com.ddm
    groups: [ "cfd","se","common" ] #"cfd>se"
    tags: [ "gray", "hotfix" ]
    ttl: 30S
    provider:
      type: jdbc
      options:
        jdbc-url: jdbc:mysql://localhost:3306/test
        username: root
        password: root
        hikari:
          maximum-pool-size: 10
          connection-timeout: 3000

---

spring:
  config:
    activate:
      on-profile: test

grpc:
  client:
    user-service:
      address: "cloud:///demo-user-rpc.test.local"
    order-service:
      address: "cloud:///demo-order-rpc.test.local"

---

spring:
  config:
    activate:
      on-profile: dev

grpc:
  client:
    user-service:
      address: "cloud:///demo-user-rpc.dev.local"
    order-service:
      address: "cloud:///demo-order-rpc.dev.local"